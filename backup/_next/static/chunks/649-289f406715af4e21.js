"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{649:function(e,t,n){n.d(t,{D5:function(){return _},Jx:function(){return O},un:function(){return g}});var r=n(2265),a=n(4887);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function l(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}let s={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"};class u{static async load(e,t){var n;let r=e.libraries?e.libraries.split(","):[],a=this.serializeParams(e);for(let o of(null!=(n=window.google)&&null!=(n=n.maps)&&n.importLibrary?(this.serializedApiParams||(this.loadingStatus=s.LOADED),t(this.loadingStatus)):(this.serializedApiParams=a,this.initImportLibrary(e,t)),this.serializedApiParams&&this.serializedApiParams!==a&&console.warn("The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect."),["maps",...r]))await google.maps.importLibrary(o)}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e,t){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.warn("initImportLibrary can only be called once.",e);return}let n=null,r=r=>n||(n=new Promise((n,a)=>{var o;let i=document.createElement("script"),l=new URLSearchParams;for(let[t,n]of Object.entries(e)){let e=t.replace(/[A-Z]/g,e=>"_"+e[0].toLowerCase());l.set(e,n)}l.set("libraries",r),l.set("callback","__googleMapsCallback__"),i.src="https://maps.googleapis.com/maps/api/js?"+l.toString(),window.__googleMapsCallback__=()=>{this.loadingStatus=s.LOADED,t(this.loadingStatus),n()},window.gm_authFailure=()=>{this.loadingStatus=s.AUTH_FAILURE,t(this.loadingStatus)},i.onerror=()=>{this.loadingStatus=s.FAILED,t(this.loadingStatus),a(Error("The Google Maps JavaScript API could not load."))},i.nonce=(null==(o=document.querySelector("script[nonce]"))?void 0:o.nonce)||"",this.loadingStatus=s.LOADING,t(this.loadingStatus),document.head.append(i)}));google.maps.importLibrary=e=>r(e).then(()=>google.maps.importLibrary(e))}}u.loadingStatus=s.NOT_LOADED,u.serializedApiParams=void 0;let d=["onLoad","apiKey","libraries"],c=["children"],m=r.createContext(null),g=e=>{let{children:t}=e,n=i(e,c),{mapInstances:a,addMapInstance:s,removeMapInstance:g,clearMapInstances:p}=function(){let[e,t]=(0,r.useState)({});return{mapInstances:e,addMapInstance:(e,n="default")=>{t(t=>o({},t,{[n]:e}))},removeMapInstance:(e="default")=>{t(t=>i(t,[e].map(l)))},clearMapInstances:()=>{t({})}}}(),{status:f,loadedLibraries:h,importLibrary:v}=function(e){let{onLoad:t,apiKey:n,libraries:a=[]}=e,l=i(e,d),[s,c]=(0,r.useState)(u.loadingStatus),[m,g]=(0,r.useReducer)((e,t)=>o({},e,{[t.name]:t.value}),{}),p=(0,r.useMemo)(()=>null==a?void 0:a.join(","),[a]),f=(0,r.useMemo)(()=>JSON.stringify(l),[l]),h=(0,r.useCallback)(async e=>{var t;if(m[e])return m[e];if(!(null!=(t=google)&&null!=(t=t.maps)&&t.importLibrary))throw Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");let n=await window.google.maps.importLibrary(e);return g({name:e,value:n}),n},[m]);return(0,r.useEffect)(()=>{(async()=>{try{for(let e of(await u.load(o({key:n,libraries:p},l),e=>c(e)),["core","maps",...a]))await h(e);t&&t()}catch(e){console.error("<ApiProvider> failed to load Google Maps API",e)}})()},[n,p,f]),{status:s,loadedLibraries:m,importLibrary:h}}(n);return r.createElement(m.Provider,{value:{mapInstances:a,addMapInstance:s,removeMapInstance:g,clearMapInstances:p,status:f,loadedLibraries:h,importLibrary:v}},t)};function p(){var e;return(null==(e=(0,r.useContext)(m))?void 0:e.status)||s.NOT_LOADED}function f(){return p()===s.LOADED}let h=new Set,v={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},b=["bounds_changed","center_changed","heading_changed","projection_changed","tilt_changed","zoom_changed"],E=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],y=Object.keys(v),L=["center","zoom","heading","tilt"],w=["mapId"],A=["id","initialBounds"],C=r.createContext(null),_=e=>{let{children:t,id:n,className:a,style:l,viewState:u,viewport:d}=e,c=(0,r.useContext)(m),g=p();if(!c)throw Error("<Map> can only be used inside an <ApiProvider> component.");let[_,S]=function(e,t){let n=f(),[a,o]=(0,r.useState)(null),[l,s]=function(){let[e,t]=(0,r.useState)(null);return[e,(0,r.useCallback)(e=>t(e),[t])]}(),{id:u,initialBounds:d}=e,c=i(e,A);return(0,r.useEffect)(()=>{if(!l||!n)return;let{addMapInstance:e,removeMapInstance:r}=t,a=new google.maps.Map(l,c);return o(a),e(a,u),d&&a.fitBounds(d),()=>{l&&n&&(google.maps.event.clearInstanceListeners(a),o(null),r(u))}},[u,l,n,e.mapId]),(0,r.useEffect)(()=>{if(!u)return;let{mapInstances:e}=t;e[u]&&e[u]!==a&&function(...e){let t=JSON.stringify(e);h.has(t)||(h.add(t),console.error(...e))}(`The map id '${u}' seems to have been used multiple times. This can lead to unexpected problems when accessing the maps. Please use unique ids for all <Map> components.`)},[u,t,a]),[a,s]}(e,c),D=(0,r.useRef)({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});!function(e,t,n){let{center:a,zoom:o,heading:l,tilt:s}=n,u=i(n,L),d=a?a&&"object"==typeof a&&"lat"in a&&"lng"in a&&Number.isFinite(a.lat)&&Number.isFinite(a.lng)?a:a.toJSON():null,c=d&&d.lat,m=d&&d.lng;(0,r.useEffect)(()=>{if(!e)return;let t=i(u,w);e.setOptions(t)},[u]),(0,r.useLayoutEffect)(()=>{e&&Number.isFinite(c)&&Number.isFinite(m)&&(t.current.center.lat!==c||t.current.center.lng!==m)&&e.moveCamera({center:{lat:c,lng:m}})},[c,m]),(0,r.useLayoutEffect)(()=>{e&&Number.isFinite(o)&&t.current.zoom!==o&&e.moveCamera({zoom:o})},[o]),(0,r.useLayoutEffect)(()=>{e&&Number.isFinite(l)&&t.current.heading!==l&&e.moveCamera({heading:l})},[l]),(0,r.useLayoutEffect)(()=>{e&&Number.isFinite(s)&&t.current.tilt!==s&&e.moveCamera({tilt:s})},[s])}(_,D,e),function(e,t,n){for(let a of y){let o=n[a],i=v[a];(0,r.useEffect)(()=>{if(!e||!o)return;let n=google.maps.event.addListener(e,i,n=>{let r=function(e,t,n){let r={type:e,map:t,detail:{},stoppable:!1,stop:()=>{}};if(b.includes(e)){let e=t.getCenter(),n=t.getZoom(),a=t.getHeading()||0,o=t.getTilt()||0,i=t.getBounds();return e&&i&&Number.isFinite(n)||console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),r.detail={center:(null==e?void 0:e.toJSON())||{lat:0,lng:0},zoom:n,heading:a,tilt:o,bounds:(null==i?void 0:i.toJSON())||{north:90,east:180,south:-90,west:-180}},r}if(E.includes(e)){var a;if(!n)throw Error("[createEvent] mouse events must provide a srcEvent");return r.domEvent=n.domEvent,r.stoppable=!0,r.stop=()=>n.stop(),r.detail={latLng:(null==(a=n.latLng)?void 0:a.toJSON())||null,placeId:n.placeId},r}return r}(i,e,n);(function(e,t){if(!e.detail.center)return;let{center:n,zoom:r,heading:a,tilt:o}=e.detail;t.current.center=n,t.current.heading=a,t.current.tilt=o,t.current.zoom=r})(r,t),o(r)});return()=>n.remove()},[e,t,i,o])}}(_,D,e),(0,r.useLayoutEffect)(()=>{if(!_||!u)return;_.setOptions({gestureHandling:"none",keyboardShortcuts:!1,disableDefaultUI:!0});let{latitude:e,longitude:t,bearing:n,pitch:r,zoom:a}=u;_.moveCamera({center:{lat:e,lng:t},heading:n,tilt:r,zoom:a+1})},[_,u]);let O=(0,r.useMemo)(()=>!!d,[d]),k=(0,r.useMemo)(()=>o({width:"100%",height:"100%",zIndex:O?-1:0},l),[l,O]);return g===s.AUTH_FAILURE?r.createElement("div",{style:o({position:"relative"},a?{}:k),className:a},r.createElement(I,null)):r.createElement("div",o({ref:S,"data-testid":"map",style:a?void 0:k,className:a},n?{id:n}:{}),_?r.createElement(C.Provider,{value:{map:_}},t):null)};_.deckGLViewProps=!0;let I=()=>r.createElement("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"}},r.createElement("h2",null,"Error: AuthFailure"),r.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",r.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details.")),S=r.createContext(null);(0,r.forwardRef)((e,t)=>{let{children:n}=e,[o,i]=function(e){var t;let[n,a]=(0,r.useState)(null),[o,i]=(0,r.useState)(null),l=null==(t=(0,r.useContext)(C))?void 0:t.map,s=function(e){let t=f(),n=(0,r.useContext)(m);return(0,r.useEffect)(()=>{t&&n&&n.importLibrary(e)},[t,null==n?void 0:n.importLibrary]),(null==n?void 0:n.loadedLibraries[e])||null}("marker"),{children:u,className:d,onClick:c,onDrag:g,onDragStart:p,onDragEnd:h,collisionBehavior:v,draggable:b,position:E,title:y,zIndex:L}=e,w=r.Children.count(u);return(0,r.useEffect)(()=>{if(!l||!s)return;let e=new s.AdvancedMarkerElement;if(e.map=l,a(e),w>0){let t=document.createElement("div");d&&(t.className=d),e.content=t,i(t)}return()=>{e.map=null,a(null),i(null)}},[l,s,w]),(0,r.useEffect)(()=>{if(!n)return;let e=google.maps.event;return c&&e.addListener(n,"click",c),g&&e.addListener(n,"drag",g),p&&e.addListener(n,"dragstart",p),h&&e.addListener(n,"dragend",h),(g||p||h)&&!b&&console.warn("You need to set the marker to draggable to listen to drag-events."),()=>{e.clearInstanceListeners(n)}},[n,b,c,p,g,h]),(0,r.useEffect)(()=>{n&&(void 0!==E&&(n.position=E),void 0!==b&&(n.gmpDraggable=b),void 0!==v&&(n.collisionBehavior=v),void 0!==L&&(n.zIndex=L),"string"==typeof y&&(n.title=y))},[n,E,b,v,L,y]),[n,o]}(e);return((0,r.useImperativeHandle)(t,()=>o,[o]),o)?r.createElement(S.Provider,{value:{marker:o}},null!==i&&(0,a.createPortal)(n,i)):null});let D=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"],O=(0,r.forwardRef)((e,t)=>{let n=function(e){var t;let[n,a]=(0,r.useState)(null),o=null==(t=(0,r.useContext)(C))?void 0:t.map,{onClick:l,onDrag:s,onDragStart:u,onDragEnd:d,onMouseOver:c,onMouseOut:m}=e,g=i(e,D),{position:p,draggable:f}=g;return(0,r.useEffect)(()=>{if(!o){void 0===o&&console.error("<Marker> has to be inside a Map component.");return}let e=new google.maps.Marker(g);return e.setMap(o),a(e),()=>{e.setMap(null),a(null)}},[o]),(0,r.useEffect)(()=>{if(!n)return;let e=google.maps.event;return l&&e.addListener(n,"click",l),s&&e.addListener(n,"drag",s),u&&e.addListener(n,"dragstart",u),d&&e.addListener(n,"dragend",d),c&&e.addListener(n,"mouseover",c),m&&e.addListener(n,"mouseout",m),n.setDraggable(!!f),()=>{e.clearInstanceListeners(n)}},[n,f,l,s,u,d,c,m]),(0,r.useEffect)(()=>{n&&g&&n.setOptions(g)},[n,g]),(0,r.useEffect)(()=>{!f&&p&&n&&n.setPosition(p)},[f,p,n]),n}(e);return(0,r.useImperativeHandle)(t,()=>n,[n]),r.createElement(r.Fragment,null)})}}]);